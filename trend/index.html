<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Movie Explorer + AI Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <base href="/trend/">

  <!-- Main Style -->
  <link rel="stylesheet" href="./css/style.css" />
</head>

<body>

  <h1>üé¨ Movie Explorer</h1>

  <!-- ================= CONTROL PANEL ================= -->
  <section class="control-pane">
    <div class="control-group">
      <label for="tmdb-api-key">TMDB API Key</label>
      <div class="api-key-row">
        <input id="tmdb-api-key" type="password" placeholder="TMDB API Key" autocomplete="off" />
        <button id="toggle-tmdb-key" type="button">üëÅÔ∏è</button>
        <button id="save-tmdb" type="button" class="control-actions primary">Save</button>
        <button id="test-tmdb" type="button" class="control-actions">Test</button>
      </div>
      <div id="tmdb-status" class="status" style="margin-top:8px;"></div>
    </div>

    <!-- AI settings will be moved into the modal AI panel (below #aiGenContainer) by main.js -->
    <div id="ai-settings-pane" style="display:none">
      <div class="control-group">
        <label for="ai-provider">AI Provider</label>
        <select id="ai-provider">
          <option value="gemini">Google Gemini</option>
          <option value="openai">OpenAI</option>
          <option value="openrouter">OpenRouter (GPT)</option>
        </select>
      </div>

      <div class="api-key-row">
        <input id="ai-api-key" type="password" placeholder="API Key" autocomplete="off" />
        <button id="toggle-api-key" type="button">üëÅÔ∏è</button>
      </div>

      <div class="control-group" style="margin-top:8px; display:flex; gap:8px; align-items:center;">
        <label style="font-size:13px; display:flex; gap:8px; align-items:center;">
          <input id="remember-keys" type="checkbox" checked /> Remember
        </label>
        <button id="forget-keys" type="button" class="control-actions">Forget keys</button>
      </div>

      <button id="save-settings">Save</button>
      <button id="test-settings">Test</button>

      <div id="settings-status" class="status"></div>
    </div>
  </section>

  <!-- ================= FILTER / SORT ================= -->
  <div class="controls">
    <select id="mediaType">
      <option value="movie">Movie</option>
      <option value="tv">TV</option>
    </select>

    <select id="mediaCategory"></select>

    <select id="genreFilter"></select>
    <select id="yearFilter"></select>

    <select id="sortFilter">
      <option value="popularity.desc">Popularity Desc</option>
      <option value="popularity.asc">Popularity Asc</option>
      <option value="vote_average.desc">Rating Desc</option>
      <option value="vote_average.asc">Rating Asc</option>
      <option value="combined.desc">Combined: Popularity + Rating (Desc)</option>
      <option value="combined.asc">Combined: Popularity + Rating (Asc)</option>
    </select>

    <div style="flex-wrap: wrap;margin-left:8px; display:flex; gap:8px; align-items:center;">
      <input id="searchInput" type="search" placeholder="Search movies or TV..." style="width:260px; height:30px; padding:6px; border-radius:6px; background:#111; color:#fff; border:1px solid #333;" onkeydown="if(event.key==='Enter')doSearch()">
      <button id="searchBtn" onclick="doSearch()">Search</button>
      <button id="clearSearch" onclick="clearSearch()">Clear</button>
    </div>

    <div style="display:flex; gap:12px; align-items:center; margin-left:8px;">
      <div>
        <label style="font-size:12px; display:block;">User Score: (<span id="scoreLabel">0</span>-10)</label>
        <input id="scoreSlider" type="range" min="0" max="10" step="0.5" value="0" oninput="onScoreChange(this.value)">
      </div>
      <div>
        <label style="font-size:12px; display:block;">Min Votes: <span id="votesLabel">0</span></label>
        <input id="votesSlider" type="range" min="0" max="1000" step="50" value="0" oninput="onVotesChange(this.value)">
      </div>
    </div>

    <div style="margin-left:8px; display:flex; gap:8px;">
      <button id="applyFilters" onclick="applyAllFilters()" class="control-actions primary">Apply Filters</button>
      <button id="resetFilters" onclick="resetFilters()" class="control-actions">Reset</button>
      <button id="helpBtn" onclick="openHelp()" class="control-actions">Help</button>
    </div>
  </div>

  <!-- ================= GRID ================= -->
  <div id="loader">‚è≥ Loading...</div>
  <div id="movieGrid" class="movie-grid"></div>

  <!-- ================= PAGINATION ================= -->
  <div class="pagination" id="pagination"></div>

  <!-- ================= MODAL ================= -->
  <div id="modal">
    <div id="modalContent">
      <button id="closeModal">√ó</button>
      <div id="modalBackdrop"></div>

      <img id="modalPoster" />
      <img id="modalBackdropImage" />

      <div id="modalDetails">
        <h2 id="modalTitle"></h2>

        <div class="modalMC">
          <div id="modalMeta"></div>
          <div id="modalMeta-cast"></div>
        </div>

        <p id="modalOverview"></p>

        <div id="modalTrailer"></div>
      </div>
    </div>
  </div>

    <!-- Gallery overlay dipindahkan ke luar modal -->
    <div id="galleryOverlay" aria-hidden="true">
        <div id="galleryInner">
            <button id="galleryClose" onclick="closeGallery()">&times;</button>
            <div id="galleryGrid" role="list"></div>
            <div id="galleryGridBackdrop" role="list" style="display:none;"></div>
        </div>
    </div>

  <!-- ================= SCRIPTS ================= -->
  <script src="./js/ai.js?v=23"></script>
  <script src="./js/settings.js?v=23"></script>
  <script src="./js/tmdb.js?v=23"></script>
  <script src="./js/main.js?v=24"></script>

</body>
</html>
